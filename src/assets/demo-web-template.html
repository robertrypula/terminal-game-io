<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Terminal Game UI - web demo</title>
  <style>
    .mobile-device-buttons {
      position: fixed;
      display: block;
      width: 33%;
      height: 50%;
    }
    .mobile-device-buttons:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }
  </style>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body onLoad="run()">
  <pre id="root"></pre>

  <a
    href="javascript:void(0)" onClick="handleClick(event, 'ClickDown')"
    class="mobile-device-buttons" style="top: 50%; left: 33%;"
  ></a>
  <a
    href="javascript:void(0)" onClick="handleClick(event, 'ClickUp')"
    class="mobile-device-buttons" style="top: 0; left: 33%;"
  ></a>
  <a
    href="javascript:void(0)" onClick="handleClick(event, 'ClickLeft')"
    class="mobile-device-buttons" style="top: 50%; left: 0;"
  ></a>
  <a
    href="javascript:void(0)" onClick="handleClick(event, 'ClickRight')"
    class="mobile-device-buttons" style="top: 50%; left: 66%;"
  ></a>

  <script>
    var FPS = 5;
    var BOARD_WIDTH = 40;
    var BOARD_HEIGHT = 12;

    var terminalGameIo;
    var lastKeyName = '';
    var posX = Math.round(BOARD_WIDTH / 2);
    var posY = Math.round(BOARD_HEIGHT / 2);
    var frameNumber = 0;

    function frameHandler(instance) {
      var frameData = '';

      for (var y = 0; y < BOARD_HEIGHT; y++) {
        for (var x = 0; x < BOARD_WIDTH; x++) {
          frameData += (posX === x && posY === y) ? '@' : '.';
        }
      }

      instance.drawFrame(frameData, BOARD_WIDTH, BOARD_HEIGHT);
      instance.write('Frame: ' + (frameNumber++) + '\n');
      instance.write('Time: ' + instance.getTime().toFixed(3) + 's\n');
      instance.write('Last key name: ' + lastKeyName + '\n\n');
      instance.write('Use arrows to move.\n');
      instance.write('Press Escape to exit...\n');
    }

    function keypressHandler(instance, keyName) {
      lastKeyName = keyName;

      frameHandler(instance);

      switch (keyName) {
        case 'Down':
        case 'ArrowDown':
        case 'ClickDown':
          posY = (posY + 1) % BOARD_HEIGHT;
          break;
        case 'Up':
        case 'ArrowUp':
        case 'ClickUp':
          posY = posY === 0 ? BOARD_HEIGHT - 1 : posY - 1;
          break;
        case 'Left':
        case 'ArrowLeft':
        case 'ClickLeft':
          posX = posX === 0 ? BOARD_WIDTH - 1 : posX - 1;
          break;
        case 'Right':
        case 'ArrowRight':
        case 'ClickRight':
          posX = (posX + 1) % BOARD_WIDTH;
          break;
        case 'Esc':
        case 'Escape':
          instance.exit();
          break;
      }
    }

    function handleClick(event, keyName) {
      event.preventDefault();
      if (terminalGameIo) {
        terminalGameIo.triggerKeypress(keyName);
      }
    }

    function run() {
      terminalGameIo = TerminalGameIo.createTerminalGameIo({
        // domElementId: 'my-custom-id',     // default: 'root'
        fps: FPS,
        frameHandler: frameHandler,
        keypressHandler: keypressHandler
      });
    }
  </script>
  <!-- you can access distribution version via: <script src="https://unpkg.com/terminal-game-io"></script> -->
</body>
</html>
